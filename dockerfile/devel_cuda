ARG CUDA_VERSION
ARG CUDNN_VERSION
ARG UBUNTU_VERSION

# https://hub.docker.com/r/nvidia/cuda/tags
FROM nvidia/cuda:${CUDA_VERSION}-cudnn${CUDNN_VERSION}-devel-ubuntu${UBUNTU_VERSION}

ARG PYTHON_VERSION

ENV PYTHONIOENCODING=UTF-8 \
    LC_CTYPE=C.UTF-8 \
    LANG=C.UTF-8 \
    LC_ALL=C.UTF-8 \
    FIXUID_USER=wden \
    FIXUID_GROUP=wden \
    WDEN_BUILD_FOLDER=/.wden-build \
    WDEN_RUN_FOLDER=/.wden-run

COPY build "$WDEN_BUILD_FOLDER"
COPY run "$WDEN_RUN_FOLDER"

RUN "$WDEN_BUILD_FOLDER"/devel_cuda.sh

# install_fixuid.sh
USER "$FIXUID_USER":"$FIXUID_GROUP"
