ARG UBUNTU_VERSION

# https://hub.docker.com/r/nvidia/cuda/tags
FROM ubuntu:${UBUNTU_VERSION}

ARG PYTHON_VERSION

ENV PYTHONIOENCODING=UTF-8 \
    LC_CTYPE=C.UTF-8 \
    LANG=C.UTF-8 \
    LC_ALL=C.UTF-8 \
    FIXUID_USER=wden \
    FIXUID_GROUP=wden \
    WDEN_BUILD_FOLDER=/root/.wden-build \
    WDEN_RUN_FOLDER=/root/.wden-run

COPY build "$WDEN_BUILD_FOLDER"

RUN "$WDEN_BUILD_FOLDER"/devel_cpu.sh

COPY --chown="$FIXUID_USER":"$FIXUID_GROUP" run "$WDEN_RUN_FOLDER"

# install_fixuid.sh
USER "$FIXUID_USER":"$FIXUID_GROUP"
ENTRYPOINT ["fixuid"]
